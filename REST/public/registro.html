<!DOCTYPE html>
<html lang="en">
<head>
    <title>Registro: FaceBOS</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script type="text/javascript" src="jquery-2.2.4.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div id="index" class="link">
    <a href="index.html">Login</a>
</div>

<div id="Registro">
    <div id="errReg">
        <div id="error" class="oculto">ERROR: !Los campos están vacíos¡</div><!--Mensaje de error de campos vacios -->
        <div id="passEmpty" class="oculto">ERROR: !Introduzca contraseña¡</div><!--Mensaje de error de password vacio -->
        <div id="passDesigual" class="oculto">ERROR: !Las contraseñas no coinciden¡</div><!--Mensaje de error de password desiguales -->
        <div id="userExists" class="oculto" style="margin-left: -68px;">ERROR: !El usuario introducido ya existe¡<br></div><!--Mensaje ususario ya existente -->
    </div>

    <form action="../social_api/src/social/services/user_service.java" method="post">
        <label> Nombre </label><br>
        <input type="text" id="nombre" required/><br>
        <label> Apellidos </label><br>
        <input name="apellido" type="text" id="apellido" required/><br>
        <label> Correo </label><br>
        <input name="user" type="text" id="user" required /><br>
        <label> Contraseña </label><br>
        <input name="pwd" type="password" id="pwd" required/><br>
        <label> Repita la contraseña </label><br>
        <input name="rpwd" type="password" id="rpwd" required/><br>
        <button type="button" class="button" onclick="saveUser()">Enviar</button><br>
    </form>
</div>

</body>
</html>

<script>

    var url = document.URL;
    if(url.includes('?error=1')){
        document.getElementById('userExists').setAttribute('class','error');
        document.getElementById('nombre').value=localStorage.getItem('nombre');
        document.getElementById('apellido').value=localStorage.getItem('apellido');
        document.getElementById('user').value=localStorage.getItem('user');
        document.getElementById('user').focus();
    }
    function comprobarCampos(){
        var nombre=document.getElementById('nombre').value.trim();
        var apellido=document.getElementById('apellido').value.trim();
        var user=document.getElementById('user').value.trim();

        //var pwd=document.getElementById('pwd').value;
        //var rpwd=document.getElementById('rpwd').value;

        var error='';
        var fallo=false;
        if(nombre==''){
            error="Nombre";
            fallo=true;
        }
        if(apellido==""){
            if(error!="") error=error+", Apellido";
            else error="Apellido";
            fallo=true;
        }
        if(user==""){
            if(error!="") error=error+", Correo";
            else error="Correo";
            fallo=true;
        }
        /*if(pwd=="" || rpwd==""){
            if(error!="") error=error+", Contraseña";
            else error="Contraseña";
            fallo=true;
            document.getElementById('passEmpty').innerHTML="Debe rellenar el campo contraseña";
            document.getElementById('passEmpty').setAttribute("class","error");
        }else if (pwd!=rpwd){
            fallo=true;
            document.getElementById('passDesigual').innerHTML="Las contraseñas no son iguales";
            document.getElementById('passDesigual').setAttribute("class","error");
        }*/

        if (fallo) {
            console.log(error);
            document.getElementById('error').innerHTML="Debe rellenar: "+error;
            document.getElementById('error').setAttribute("class","error");
            return false;
        } else {
            console.log(error);
            saveUser();
        }
    }
    function saveUser(){
        var userData =
            {name: document.getElementById("nombre").value,
            apellidos: document.getElementById("apellido").value,
            correo: document.getElementById("user").value
            };

        var userJson = JSON.stringify(userData);

        sessionStorage.setItem(userJson,"usuarioJSON");
    }
</script>